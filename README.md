# Notion Accessibility Enhancer

Notion をスクリーンリーダーやキーボードでより使いやすくするための Chrome 拡張機能です。

## 機能

- クリック可能な要素に適切な ARIA ロールとラベルを追加
- キーボード操作のサポート（Enter キーと Space キーでクリック動作）
- 不適切なアクセシビリティラベルの修正
- 動的に追加される要素への自動的な対応
- Notion の内部保護機能（DOMLock）と互換性のある設計
- ローディング UI 要素（スケルトンローダー、スピナー）のアクセシビリティ対応
- パフォーマンス最適化（デバウンス処理、バッチ処理）

## インストール方法

1. このリポジトリをクローンまたはダウンロード

```bash
git clone https://github.com/Gashin0601/Accessible-notion.git
```

2. Chrome 拡張機能の管理ページを開く

   - Chrome ブラウザで `chrome://extensions` を開く
   - 右上の「デベロッパーモード」をオンにする

3. 「パッケージ化されていない拡張機能を読み込む」をクリック
   - `extension`フォルダを選択

## 使用方法

インストール後、Notion のページを開くと自動的にアクセシビリティの改善が適用されます。

- クリック可能な要素がボタンとして認識されるようになります
- キーボードでの操作が改善されます（Enter キー、Space キーでクリック可能）
- スクリーンリーダーでの読み上げが改善されます
- ローディング状態も適切に通知されます

## 最新の改善点（2024 年 3 月）

- **Notion の内部保護機能（DOMLock）との互換性向上**：

  - 特定の保護された要素（メンショントークンなど）を自動検出してスキップ
  - 編集可能領域内の要素への不要な変更を防止
  - コンソールの警告メッセージを大幅に削減

- **パフォーマンスの最適化**：

  - MutationObserver のデバウンス処理（200ms）
  - 要素の一括処理による DOM 操作の効率化
  - 非表示要素や処理済み要素のスキップ

- **アクセシビリティの強化**：
  - 要素の種類に基づいた適切なラベル推測機能
  - ローディング UI 要素への適切な ARIA 属性設定
  - 空のラベルや不適切なラベル（「touch」など）の自動修正

## 開発者向け情報

### ファイル構成

```
.
├── extension/           # Chrome拡張機能本体
│   ├── icons/          # アイコンファイル
│   ├── manifest.json   # 拡張機能の設定
│   ├── contentScript.js # メインスクリプト
│   └── convert-icon.js # アイコン変換スクリプト
├── node_modules/       # npm依存関係
├── .gitignore         # Git除外設定
├── package.json       # npm設定
└── package-lock.json  # npm依存関係のロック
```

### ビルド方法

このプロジェクトは特別なビルド手順を必要としません。

### デバッグ方法

`contentScript.js`の先頭にある`DEBUG`定数を`true`に設定することで、詳細なデバッグログがコンソールに出力されます。本番環境では`false`に設定してください。

## ライセンス

MIT License

## 貢献について

バグ報告や機能改善の提案は、GitHub の Issue や Pull Request でお願いします。
